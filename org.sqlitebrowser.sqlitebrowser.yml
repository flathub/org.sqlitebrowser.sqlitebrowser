app-id: org.sqlitebrowser.sqlitebrowser
runtime: org.kde.Platform
runtime-version: 5.15-25.08
sdk: org.kde.Sdk
command: sqlitebrowser
rename-icon: sqlitebrowser
rename-desktop-file: sqlitebrowser.desktop
rename-appdata-file: sqlitebrowser.desktop.appdata.xml
finish-args:
  - --socket=wayland
  - --socket=fallback-x11
  - --device=dri
  - --filesystem=home
  - --share=network
  - --share=ipc
cleanup:
  - /include
  - '*.la'

modules:
  - name: sqlcipher
    buildsystem: autotools
    build-options:
      cflags: -DSQLITE_HAS_CODEC -DSQLITE_EXTRA_INIT=sqlcipher_extra_init -DSQLITE_EXTRA_SHUTDOWN=sqlcipher_extra_shutdown
      ldflags: -lcrypto
    config-opts:
      - --with-tempstore=yes
      - --disable-static
      - --disable-tcl
    sources:
      - type: git
        url: https://github.com/sqlcipher/sqlcipher.git
        tag: v4.11.0
        commit: c6e8461bfa0b7317dfd96278dd950b1eb6b21a1a
        x-checker-data:
          type: git
          tag-pattern: ^v([\d.]+)$

  - name: sqlitebrowser
    buildsystem: cmake-ninja
    config-opts:
      - -DFORCE_INTERNAL_QSCINTILLA=TRUE
      - -Dsqlcipher=1
      - -Wno-dev
      - -DCMAKE_POLICY_VERSION_MINIMUM=3.5
    sources:
      - type: git
        url: https://github.com/sqlitebrowser/sqlitebrowser.git
        tag: v3.13.1
        commit: 5d84f53f85570a31767548cded89c96de6ff70ae
        x-checker-data:
          type: git
          tag-pattern: ^v([\d.]+)$

      # support sqlcipher >= 4.7.0
      - type: patch
        path: sqlcipher.patch
